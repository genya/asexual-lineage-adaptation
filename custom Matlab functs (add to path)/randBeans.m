function randBeans = randBeans(probHist,n)
%randBeans = randBeans(probHist,n)
%
%randBeans = a list of n integers with range from 1 to length(probHist). 
%The probability of integer i = probHist(i).
%
% assumes that sum(probHist) = 1

%draw n random numbers on [0, 1]
randBeans = rand(n,1);

%compute cumulative distribution of probHist
probHistCDF = [0; cumsum(probHist(:))];

%assign rand beans to bins
k = zeros(n,1);
for i=2:length(probHistCDF);
    pick = probHistCDF(i) - randBeans >= 0;
    k(pick & k == 0)  = i-1;
end

randBeans = k;

end

%% test randBeans()

% probHist = [...
%        0.000205324456327; ...
%    0.725367618148934; ...
%    0.002404189201390; ...
%    0.000914494741655; ...
%    0.000744119128958; ...
%    0.001993540288736; ...
%    0.012631094568658; ...
%    0.007308676924152; ...
%    0.009067768720202; ...
%    0.010404561989055; ...
%    0.001460570423376; ...
%    0.009054662903841; ...
%    0.013009707041318; ...
%    0.008958553583858; ...
%    0.093828907936009; ...
%    0.070972364201899; ...
%    0.022064369945159; ...
%    0.009609475796470];
% 
% n = 10^6;
% 
% theseBeans = randBeans(probHist,n);
% 
% 
% thisHist = hist(theseBeans,1:length(probHist));
% 
% [thisHist(:)/n probHist]
